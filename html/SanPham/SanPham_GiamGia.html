<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sản phẩm</title>
    <link rel="stylesheet" href="../../css/bootstrap.min.css">
    <link href="../../css/all.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/template.css">
    <script src="../../js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #173d58;
        }

        h3 {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .filter-group {
            border-top: 1px solid #ffffff30;
            padding: 15px 0;
        }

        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 17px;
            cursor: pointer;
        }

        .filter-content {
            margin-top: 10px;
            display: none;
            font-size: 15px;
            color: #fff;
            animation: fadeIn 0.3s ease-in-out;
        }

        .filter-content.show {
            display: block;
        }

        .filter-content div {
            margin: 6px 0;
            cursor: pointer;
        }

        .price-slider {
            width: 100%;
        }

        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-top: 5px;
        }

        #category a {
            color: white;

        }

        #category a:hover {
            color: #e74c3c;
            font-size: 20px;
            transition: all 0.3s ease;
        }

        input[type=range] {
            width: 100%;
            appearance: none;
            height: 4px;
            background: #ddd;
            border-radius: 3px;
            outline: none;
        }

        input[type=range]::-webkit-slider-thumb {
            appearance: none;
            width: 15px;
            height: 15px;
            background: #fff;
            border: 2px solid #ff3e3e;
            border-radius: 50%;
            cursor: pointer;
        }

        .icon-toggle {
            font-size: 14px;
            margin-left: 10px;
            transition: transform 0.2s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        nav ul li a:hover {
            color: #e74c3c;
            transition: all 0.3s ease;
        }

        .price-input-container {
            position: relative;
            margin-bottom: 15px;
        }

        .price-input {
            width: 100%;
            padding: 8px 30px 8px 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: left;
        }

        .currency-symbol {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-weight: bold;
        }

        /* Thêm style cho input khi focus */
        .price-input:focus {
            outline: none;
            border-color: #e74c3c;
            box-shadow: 0 0 0 2px rgba(231, 76, 60, 0.2);
        }

        /*sản phẩm*/
        .products-row {
            flex-wrap: wrap;
            gap: 20px;
            margin: 0;
            align-items: stretch;
        }

        .product-container {
            flex: 0 0 calc(25% - 20px);
            max-width: calc(25% - 20px);
            box-sizing: border-box;
            margin: 0;
        }

        .product-container[style*="display: none"] {
            display: none !important;
        }

        .product-card {
            width: 100%;
            background-color: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin: 15px;
            font-family: "Segoe UI", sans-serif;
            transition: transform 0.3s;
        }

        .product-container[style*="display: none"] {
            display: none !important;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }


        .product-img {
            position: relative;
            background-color: #f9f9f9;
        }

        .product-img img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .label-tag {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: #e53935;
            color: #fff;
            font-size: 13px;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .quick-view {
            position: absolute;
            bottom: 0;
            width: 100%;
            text-align: center;
            background: #fff;
            padding: 8px;
            font-weight: bold;
            font-size: 14px;
            color: #333;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .quick-view a {
            text-decoration: none;
            color: #333;
        }

        .product-info {
            padding: 12px;
            text-align: center;
            background-color: #e2e2e2;
        }

        .product-info h3 {
            font-size: 16px;
            color: #1a355c;
            margin: 0 0 6px;
        }

        .product-info p {
            font-size: 14px;
            color: #000;
            font-weight: bold;
            margin: 0;
        }

        .product-card:hover .quick-view {
            opacity: 1;
        }

        /* Footer */
        #errorMessage {
            font-size: 14px;
            padding: 5px;
            background-color: rgba(255, 0, 0, 0.2);
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        #emailInput.invalid {
            border-color: #ff0000 !important;
            box-shadow: 0 0 0 2px rgba(255, 0, 0, 0.2);
        }
    </style>
</head>

<body>
    <div class="wrapper d-flex flex-column min-vh-100 container-fluid"
        style="background-color: #173d58; margin-top: -10px;">
        <header class="mb-xl-5">
            <nav class="navbar navbar-expand-xl navbar-dark fixed-top px-xl-5" style="background-color: #183c5c;">
                <div class="container-fluid">
                    <a class="navbar-brand" href="../html/TrangChu.html">Sporty</a>
                    <button class="navbar-toggler d-xl-none" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapsibleNavId" aria-controls="collapsibleNavId" aria-expanded="false"
                        aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="collapsibleNavId">
                        <ul class="navbar-nav ms-auto mt-2 mt-lg-0">
                            <li class="nav-item">
                                <a class="nav-link" href="../html/TrangChu.html" aria-current="page">Trang
                                    chủ</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle active" href="#" id="dropdownSP"
                                    data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Sản phẩm
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="dropdownSP">
                                    <li><a class="dropdown-item" href="../../html/SanPham/SanPham_DoBoi.html">Đồ bơi</a></li>
                                    <li><a class="dropdown-item" href="../../html/SanPham/SanPham_PhuKienBoi.html">Phụ kiện bơi</a></li>
                                    <li><a class="dropdown-item" href="../../html/SanPham/SanPham_GiamGia.html">Hàng giảm giá</a></li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="../html/GioiThieu.html" aria-current="page">Giới thiệu</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="../html/LienHe.html" aria-current="page">Liên hệ</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="../html/DangNhap.html"> <i class="fas fa-user me-1"></i> Đăng
                                    nhập</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="../../html/GioHang.html"> <i class="fas fa-shopping-cart me-1"></i> Giỏ hàng</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>

        <div class="main-content flex-grow-1">
            <div class="container-xxl px-3 px-md-4 px-lg-5 mx-auto" style="max-width: 1600px;">
                <h1 class="text-white text-center " style="font-size: 45px ; margin-top: 100px;">
                    GIẢM GIÁ
                </h1>

                <div class="row container ms-5">
                    <div class="col-3 text-white">
                        <h3>Lọc Theo</h3>

                        <!-- Danh mục -->
                        <div class="filter-group">
                            <div class="filter-header" onclick="animationBoLoc('category')">
                                <span>Danh mục</span>
                                <span id="icon-category" class="icon-toggle">+</span>
                            </div>
                            <div id="category" class="filter-content">
                                <a href="#" style="text-decoration: none; display: block;"><strong>Tất cả</strong></a>
                                <a href="#" style="text-decoration: none; display: block;">Đồ bơi nam</a>
                                <a href="#" style="text-decoration: none; display: block;">Đồ bơi nữ</a>
                                <a href="#" style="text-decoration: none; display: block;">Kính bơi</a>
                                <a href="#" style="text-decoration: none; display: block;">Mũ bơi</a>
                                <a href="#" style="text-decoration: none; display: block;">Bình nước</a>
                                <a href="#" style="text-decoration: none; display: block;">Túi thể thao</a>
                            </div>
                        </div>

                        <!-- Giá -->
                        <div class="filter-group">
                            <div class="filter-header" onclick="animationBoLoc('price')">
                                <span>Giá</span>
                                <span id="icon-price" class="icon-toggle">+</span>
                            </div>
                            <div id="price" class="filter-content">
                                <div class="price-input-container">
                                    <input type="text" id="priceInput" class="price-input" value="1.500.000 ₫">
                                    <span class="currency-symbol">₫</span>
                                </div>
                                <input type="range" min="150000" max="700000" step="50000" value="700000"
                                    class="price-slider" id="priceSlider">
                                <div class="range-labels">
                                    <span>200.000 ₫</span>
                                    <span>700.000 ₫</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sản phẩm -->
                    <div class="col">
                        <div class="products-row d-inline-flex flex-wrap">
                            <div class="product-container">
                                <a href="#">
                                    <div class="product-card" data-type="doboinam" data-price="600000">
                                        <div class="product-img">
                                            <img src="../../imgs/imgs_SanPham/doboinam3.jpg"
                                                alt="Quần bơi nam Champion Xám">
                                            <div class="label-tag">Giảm giá</div>
                                            <div class="quick-view"><a href="#">Xem chi tiết</a></div>
                                        </div>
                                        <a href="#" style="text-decoration: none;">
                                            <div class="product-info">
                                                <h3>Quần bơi nam Champion Vàng Đen</h3>
                                                <p><s style="color: gray; font-weight: normal;">750.000₫</s> 600.000₫
                                                </p>
                                            </div>
                                        </a>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Thêm phần đăng ký nhận ưu đãi -->
        <footer>
            <div class="row py-5 mx-auto text-light mt-5" style="background-color: #e74c3c;">
                <div class="col-4 mx-auto">
                    <h4 class=" fw-normal text-nowrap">Đăng ký ngay để được giảm 200k đơn tiếp theo</h4>
                    <form id="registerForm">
                        <input class="form-control mt-3 text-light ps-3" type="email" name="Email" id="emailInput"
                            style="border-radius: 0; border: 4px solid #e08898; background-color: #e74c3c;"
                            placeholder="Nhập email của bạn ở đây">
                        <!-- Thêm thông báo lỗi -->
                        <div id="errorMessage" style="color: white; display: none; margin-top: 5px;">
                            Vui lòng nhập địa chỉ email hợp lệ!
                        </div>
                        <button class="btn w-100 btn-light mt-3" type="submit"
                            style="border-radius: 0 12px 0 0; color: #e74c3c;">Đăng ký ngay</button>
                    </form>
                </div>
            </div>
            <div class="row py-5 mx-auto px-xl-5 text-nowrap" style="background-color: #101c2c;">
                <div class="col-2 mx-auto">
                    <h4 class="pb-2 fw-normal" style="color: #e74c3c;">Mua sắm</h4>
                    <a class="link-secondary d-block text-decoration-none" href="../../html/SanPham/SanPham_DoBoi.html">Đồ bơi</a>
                    <a class="link-secondary d-block text-decoration-none" href="../../html/SanPham/SanPham_PhuKienBoi.html">Phụ kiện</a>
                    <a class="link-secondary d-block text-decoration-none" href="../../html/SanPham/SanPham_GiamGia.html">Giảm giá</a>
                </div>
                <div class="col-2 mx-auto">
                    <h4 class="pb-2 fw-normal" style="color: #e74c3c;">Thông tin</h4>
                    <a class="link-secondary d-block text-decoration-none" href="../html/HoiDap.html">Hỏi đáp</a>
                    <a class="link-secondary d-block text-decoration-none" href="../html/GiaoTra.html">Giao hàng &
                        Trả
                        hàng</a>
                    <a class="link-secondary d-block text-decoration-none" href="../html/ChinhSach.html">Chính sách
                        cửa
                        hàng </a>
                    <a class="link-secondary d-block text-decoration-none" href="../html/ThanhToan.html">Phương thức
                        thanh toán</a>
                </div>
                <div class="col-2 mx-auto">
                    <h4 class="pb-2 fw-normal" style="color: #e74c3c;">Khám phá</h4>
                    <a class="link-secondary d-block text-decoration-none" href="../html/GioiThieu.html">Giới
                        thiệu</a>
                    <a class="link-secondary d-block text-decoration-none" href="../html/LienHe.html">Liên hệ</a>
                    <a class="link-secondary d-block text-decoration-none" href="../html/LienHe.html">Đại lý</a>
                </div>
                <div class="col-2 mx-auto">
                    <h4 class="pb-2 fw-normal" style="color: #e74c3c;">Dịch vụ khách hàng</h4>
                    <a class="link-secondary d-block text-decoration-none" href="tel:0999-123-456">Điện thoại: 0999
                        123
                        456</a>
                    <a class="link-secondary d-block text-decoration-none" href="mailto:buiquoctru@gmail.com">Email:
                        buiquoctru@gmail.com</a>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Hiển thị/ẩn bộ lọc
        function animationBoLoc(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById('icon-' + id);
            const isOpen = content.classList.toggle('show');
            icon.textContent = isOpen ? '-' : '+';
            if (isOpen) {
                content.style.animation = 'fadeIn 0.3s ease-in-out';
            } else {
                content.style.animation = 'none';
            }
        }

        // Lọc sản phẩm theo danh mục
        function filterByCategory(category) {
            const products = document.querySelectorAll('.product-container');
            const normalizedCategory = category.toLowerCase()
                .replace(/\s/g, '')
                .normalize("NFD")
                .replace(/[\u0300-\u036f]/g, "");

            products.forEach(product => {
                const productCard = product.querySelector('.product-card');
                if (!productCard) return;

                const productType = productCard.getAttribute('data-type');
                if (normalizedCategory === 'tatca' || normalizedCategory === '') {
                    product.style.display = 'block';
                } else if (productType === normalizedCategory) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
        }

        // Gắn sự kiện cho các liên kết trong "Danh mục"
        document.querySelectorAll('#category a').forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const category = this.textContent.trim();

                // Xử lý trường hợp các danh mục
                const filterValue = category === 'Tất cả' ? 'tatca' :
                                    category === 'Đồ bơi nam' ? 'doboinam' :
                                    category === 'Đồ bơi nữ' ? 'doiboinu' :
                                    category === 'Kính bơi' ? 'kinhboi' :
                                    category === 'Mũ bơi' ? 'muboi' :
                                    category === 'Bình nước' ? 'binhnuoc' :
                                    category === 'Túi thể thao' ? 'tuithethao' : '';

                filterByCategory(filterValue);
            });
        });

        // Hàm định dạng số tiền
        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN').format(price) + ' ₫';
        }

        // Hàm chuyển đổi từ chuỗi tiền tệ về số
        function parsePrice(priceStr) {
            const numStr = priceStr.replace(/[^\d]/g, '');
            return parseInt(numStr, 10) || 0;
        }

        // Xử lý sự kiện khi kéo thanh trượt
        document.getElementById('priceSlider').addEventListener('input', function () {
            const price = parseInt(this.value);
            document.getElementById('priceInput').value = formatPrice(price);
            filterByPrice(price);
        });

        // Xử lý sự kiện khi nhập giá
        document.getElementById('priceInput').addEventListener('change', function () {
            const enteredPrice = parsePrice(this.value);
            const minPrice = parseInt(document.getElementById('priceSlider').min);
            const maxPrice = parseInt(document.getElementById('priceSlider').max);

            // Giới hạn giá trị nhập vào trong khoảng min-max
            let adjustedPrice = enteredPrice;
            if (enteredPrice < minPrice) adjustedPrice = minPrice;
            if (enteredPrice > maxPrice) adjustedPrice = maxPrice;

            // Cập nhật giá trị
            document.getElementById('priceSlider').value = adjustedPrice;
            this.value = formatPrice(adjustedPrice);
            filterByPrice(adjustedPrice);
        });

        // Xử lý sự kiện khi nhập để chỉ cho phép số
        document.getElementById('priceInput').addEventListener('input', function (e) {
            // Loại bỏ các ký tự không phải số
            const sanitizedValue = this.value.replace(/[^\d]/g, '');
            this.value = sanitizedValue;
        });

        // Khởi tạo giá trị ban đầu
        const initialPrice = 700000;
        document.getElementById('priceSlider').value = initialPrice;
        document.getElementById('priceInput').value = formatPrice(initialPrice);

        // Lọc sản phẩm theo giá
        function filterByPrice(maxPrice) {
            const products = document.querySelectorAll('.product-container');
            products.forEach(product => {
                const productCard = product.querySelector('.product-card');
                if (!productCard) return;

                const productPrice = parseInt(productCard.getAttribute('data-price'), 10);
                if (productPrice <= maxPrice) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
        }

        // Gắn sự kiện cho thanh trượt giá
        document.querySelector('.price-slider').addEventListener('input', function () {
            const maxPrice = parseInt(this.value, 10); // Lấy giá trị tối đa từ thanh trượt
            filterByPrice(maxPrice); // Gọi hàm lọc theo giá
        });

        // Gắn sự kiện kiểm tra email cho form đăng ký
        document.getElementById('registerForm').addEventListener('submit', function (e) {
            e.preventDefault(); // Ngăn form submit mặc định

            const emailInput = document.getElementById('emailInput');
            const errorMessage = document.getElementById('errorMessage');
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            if (!emailPattern.test(emailInput.value)) {
                // Email không hợp lệ
                errorMessage.style.display = 'block';
                emailInput.style.borderColor = '#ff0000'; // Đổi màu border sang đỏ
            } else {
                // Email hợp lệ
                errorMessage.style.display = 'none';
                emailInput.style.borderColor = '#e08898'; // Trả lại màu border ban đầu

                // Hiển thị thông báo thành công
                alert('Đăng ký thành công! Cảm ơn bạn đã đăng ký nhận ưu đãi.');

                // Reset form
                this.reset();
            }
        });

        // Thêm sự kiện khi người dùng nhập để ẩn thông báo lỗi
        document.getElementById('emailInput').addEventListener('input', function () {
            document.getElementById('errorMessage').style.display = 'none';
            this.style.borderColor = '#e08898'; // Trả lại màu border ban đầu
        });

        document.addEventListener('DOMContentLoaded', () => {
            // Fetch JSON data
            fetch('../../data/data_GiamGia.json')
                .then(response => response.json())
                .then(data => {
                    const productContainer = document.querySelector('.products-row');
                    // Clear existing products
                    productContainer.innerHTML = '';

                    // Generate product cards
                    data.products.forEach(product => {
                        // Determine label tag
                        let labelTag = '';
                        if (product.new) {
                            labelTag = '<div class="label-tag">Mới</div>';
                        } else if (product.discount) {
                            labelTag = '<div class="label-tag">Giảm giá</div>';
                        }

                        // Format price
                        let priceHtml = '';
                        if (product.discount && product.originalPrice) {
                            priceHtml = `<p><s style="color: gray; font-weight: normal;">${product.originalPrice.toLocaleString('vi-VN')}₫</s> ${product.price.toLocaleString('vi-VN')}₫</p>`;
                        } else {
                            priceHtml = `<p>${product.price.toLocaleString('vi-VN')}₫</p>`;
                        }

                        // Create product card HTML
                        const productHtml = `
                    <div class="product-container">
                        <a href="../../html/SanPham/ChiTietSanPham_GiamGia.html?id=${product.id}">
                            <div class="product-card" data-type="${product.type}" data-price="${product.price}">
                                <div class="product-img">
                                    <img src="${product.image}" alt="${product.name}">
                                    ${labelTag}
                                    <div class="quick-view"><a href="#">Xem chi tiết</a></div>
                                </div>
                                <a href="../../html/SanPham/ChiTietSanPham_GiamGia.html?id=${product.id}" style="text-decoration: none;">
                                    <div class="product-info">
                                        <h3>${product.name}</h3>
                                        ${priceHtml}
                                    </div>
                                </a>
                            </div>
                        </a>
                    </div>
                `;

                        // Append to container
                        productContainer.insertAdjacentHTML('beforeend', productHtml);
                    });
                })
                .catch(error => console.error('Error loading JSON:', error));
        });
    </script>

</body>

</html>